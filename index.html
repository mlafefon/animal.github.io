<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משחק חידות ידע</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <div id="start-screen">
        <button id="settings-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.4-.4.4-1 .1-1.4z"/></svg>
        </button>
        <div class="start-content">
            <h1>משחק החיות</h1>
            <img id="start-screen-image" alt="חיות משחקות">
            <button id="go-to-setup-btn" class="btn btn-primary btn-large">התחל</button>
        </div>
    </div>

    <div id="setup-screen" class="container hidden">
        <main class="setup-grid">
            <div class="setup-box rules-box">
                <h2>משחק החיות - הנחיות:</h2>
                <ul>
                    <li>* כל קבוצה עונה על שאלה בתורה.</li>
                    <li>* בתשובה נכונה מגרילים ניקוד חיובי</li>
                    <li>* בתשובה חלקית מגרילים ניקוד שלילי</li>
                    <li>* במקום הגרלה שלילית ניתן להעביר שאלה</li>
                    <li>* בסיום תהייה שאלה זהה שוברת שוויון לכולם</li>
                    <li>* רק ראש הקבוצה רשאי לענות את התשובה בשם קבוצתו</li>
                </ul>
                 <div class="stats">
                    <p id="question-bank-stat">בנק שאלות: 15</p>
                    <p id="actual-questions-stat">שאלות בפועל: 15</p>
                </div>
            </div>

            <div class="setup-box">
                <h2>בחר מספר קבוצות</h2>
                <ul id="group-list" class="selection-list">
                    <li>2</li>
                    <li>3</li>
                    <li class="selected">4</li>
                    <li>5</li>
                </ul>
            </div>

            <div class="setup-box">
                <h2>בחר משחק</h2>
                <ul id="game-list" class="selection-list">
                    <!-- Games will be loaded here dynamically -->
                </ul>
            </div>
        </main>

        <footer class="options-container">
            <div class="checkbox-group">
                <input type="checkbox" id="shuffle-questions" checked>
                <label for="shuffle-questions">ערבוב שאלות</label>
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="continue-last-point">
                <label for="continue-last-point">המשך מנקודה אחרונה</label>
            </div>
        </footer>
        
        <button id="start-btn" class="btn btn-primary">התחל</button>
    </div>

    <div id="pre-question-screen" class="hidden">
        <div class="pre-question-content">
            <h1 id="pre-question-game-title">משחק: הגנת סייבר</h1>
            <h2 id="pre-question-number">שאלה 1 מתוך 8</h2>
            <p id="pre-question-time">מספר שניות למתן תשובה: 30</p>
        </div>
        <div class="main-action-container">
            <button id="bet-question-btn" class="btn btn-secondary">שאלת ההימור</button>
            <button id="next-question-btn" class="btn btn-primary">השאלה הבאה</button>
        </div>
    </div>


    <div id="game-screen" class="hidden">
        <div class="game-header">
            <div id="timer-container">
                <svg class="timer-svg" viewBox="0 0 100 100">
                    <!-- Background track -->
                    <circle class="timer-bg-track" cx="50" cy="50" r="42" />
                    <!-- Progress ring -->
                    <circle id="timer-progress-ring" cx="50" cy="50" r="42" />
                </svg>
                <span id="timer-value">30</span>
            </div>
            <div id="q-a-wrapper">
                <div id="question-container">
                    <p id="question-text">מהי מתקפת פישינג?</p>
                </div>
                <div id="answer-container" class="hidden">
                    <p id="answer-text"></p>
                </div>
            </div>
        </div>

        <div id="game-controls" class="main-action-container">
            <button id="stop-game-btn" class="btn btn-secondary btn-medium">עצור</button>
            <div id="answer-controls" class="hidden">
                <button id="correct-answer-btn" class="answer-btn"></button>
                <button id="incorrect-answer-btn" class="answer-btn"></button>
            </div>
            <div id="failure-controls" class="hidden">
                <button id="failure-box-btn" class="btn btn-danger btn-medium">תיבת כישלון</button>
                <button id="pass-question-btn" class="btn btn-secondary btn-medium">העבר שאלה</button>
            </div>
            <button id="victory-box-btn" class="btn btn-primary btn-medium hidden">תיבת נצחון</button>
        </div>
        
        <button id="undo-answer-choice-btn" class="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>
        </button>
    </div>

    <div id="boxes-screen" class="hidden">
        <div class="boxes-content">
            <h1 id="boxes-title">תיבת ניצחון (10-50)</h1>
            <div id="chests-container">
                <div class="treasure-chest" data-chest="1">
                    <img src="" alt="Treasure Chest 1">
                    <span>1</span>
                </div>
                <div class="treasure-chest" data-chest="2">
                    <img src="" alt="Treasure Chest 2">
                    <span>2</span>
                </div>
                <div class="treasure-chest" data-chest="3">
                    <img src="" alt="Treasure Chest 3">
                    <span>3</span>
                </div>
            </div>
            <p id="boxes-message">יש לבחור תיבה</p>
        </div>
        <div class="main-action-container">
            <button id="return-from-boxes-btn" class="btn btn-primary">חזרה</button>
        </div>
    </div>

    <div id="betting-screen" class="container hidden">
        <div class="betting-content">
            <h1>שאלת ההימור הסופית</h1>
            <p>כל קבוצה מהמרת על הנקודות שצברה. במענה נכון, סכום ההימור יתווסף לניקוד. בטעות, הסכום יופחת.</p>
            <div id="betting-teams-container">
                <!-- Betting team cards will be injected here by JS -->
            </div>
            <button id="show-final-question-btn" class="btn btn-primary btn-large hidden">שאלת הסיכום</button>
        </div>
    </div>

    <div id="final-question-screen" class="container hidden">
        <div class="final-question-content">
            <h1>שאלת הסיכום</h1>
            <div id="final-q-a-wrapper">
                <div id="final-question-container">
                    <p id="final-question-text"></p>
                </div>
                <div id="final-answer-container" class="hidden">
                    <p id="final-answer-text"></p>
                </div>
            </div>
            <button id="show-final-answer-btn" class="btn btn-secondary">הצג תשובה</button>
            <div id="final-scoring-container" class="hidden">
                <h2>מי ענה נכון?</h2>
                <div id="final-scoring-teams">
                    <!-- Final scoring controls for each team will be injected here -->
                </div>
            </div>
             <button id="end-game-btn" class="btn btn-primary btn-large hidden">סיים משחק וחזור למסך הראשי</button>
        </div>
    </div>


    <div id="edit-game-screen" class="container hidden">
        <div class="edit-header">
            <h1>עריכת משחקים</h1>
        </div>

        <div class="edit-sticky-actions">
            <button type="button" id="back-to-home-from-edit-btn" class="btn btn-secondary btn-medium">חזור</button>
            <div class="main-edit-actions">
                <button type="button" id="add-question-btn" class="btn btn-secondary btn-medium">הוסף שאלה</button>
                <button type="button" id="download-game-btn" class="btn btn-secondary btn-medium">הורד קובץ</button>
                <button type="button" id="save-game-btn" class="btn btn-primary btn-medium">שמור שינויים</button>
            </div>
        </div>

        <div class="edit-controls">
            <div class="form-group">
                <label for="game-editor-select">בחר משחק לעריכה:</label>
                <select id="game-editor-select">
                    <option value="">-- בחר משחק --</option>
                </select>
            </div>
            <button id="create-new-game-btn" class="btn btn-primary">צור משחק חדש</button>
        </div>

        <form id="game-editor-form" class="hidden">
            <div class="form-group">
                <label for="game-name-input">שם המשחק:</label>
                <input type="text" id="game-name-input" placeholder="הכנס שם למשחק">
            </div>

            <div class="questions-header">
                <h2>שאלות</h2>
                <div class="question-toggle-controls">
                    <button type="button" id="toggle-all-questions-btn" class="btn-icon" title="כווץ/הרחב הכל">
                        <svg class="expand-icon-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5.83L15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z"/></svg>
                        <svg class="collapse-icon-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M7.41 18.59L8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"/></svg>
                    </button>
                </div>
            </div>
            <div id="questions-editor-container">
                <!-- Questions will be dynamically inserted here -->
            </div>
            
            <h2>שאלת הסיכום</h2>
            <div class="form-group">
                <label for="final-question-q-input">שאלה:</label>
                <textarea id="final-question-q-input" rows="1" placeholder="הכנס את שאלת הסיכום"></textarea>
            </div>
            <div class="form-group">
                <label for="final-question-a-input">תשובה:</label>
                <textarea id="final-question-a-input" rows="1" placeholder="הכנס את תשובת הסיכום"></textarea>
            </div>
        </form>

        <div id="new-game-modal-overlay" class="hidden">
            <div id="new-game-modal">
                <h2>יצירת משחק חדש</h2>
                <div class="form-group">
                    <label for="new-game-name">שם המשחק:</label>
                    <input type="text" id="new-game-name" placeholder="לדוגמה: הכל על חלל">
                </div>
                <div class="form-group">
                    <label for="new-game-filename">שם הקובץ:</label>
                    <input type="text" id="new-game-filename" placeholder="לדוגמה: space_game.json">
                </div>
                <div class="modal-actions">
                    <button id="confirm-new-game-btn" class="btn btn-primary btn-small">צור</button>
                    <button id="cancel-new-game-btn" class="btn btn-secondary btn-small">בטל</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pass Question Modal -->
    <div id="pass-question-modal-overlay" class="hidden">
        <div id="pass-question-modal">
            <h2>בחר קבוצה להעביר אליה את השאלה</h2>
            <div id="pass-question-teams-container">
                <!-- Team icons will be injected here by JS -->
            </div>
            <button id="cancel-pass-question-btn" class="btn btn-secondary btn-small">בטל</button>
        </div>
    </div>

    <button id="fullscreen-toggle-btn">
        <svg id="fullscreen-enter-icon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
        <svg id="fullscreen-exit-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>
    </button>

    <button id="global-home-btn" class="hidden" title="חזור למסך הראשי">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>
    </button>

    <!-- Persistent Game Footer -->
    <div id="main-game-footer" class="game-footer">
        <div class="score-controls">
            <button class="score-btn add-point-btn" tabindex="-1">+</button>
            <button class="score-btn subtract-point-btn" tabindex="-1">-</button>
        </div>
        <div id="main-teams-container" class="teams-container">
            <!-- Teams will be generated here by JS -->
        </div>
    </div>


    <script src="index.js" type="module"></script>
</body>
</html>