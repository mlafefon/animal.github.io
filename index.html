<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משחק חידות ידע</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://cdn.jsdelivr.net/npm/appwrite@11.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
<script type="importmap">
{
  "imports": {
    "path": "https://aistudiocdn.com/path@^0.12.7",
    "vite": "https://aistudiocdn.com/vite@^7.1.12",
    "url": "https://aistudiocdn.com/url@^0.11.4"
  }
}
</script>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-container">
            <h1>משחק החיות</h1>
            <p>אנא התחבר כדי להמשיך</p>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">אימייל:</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="password">סיסמה:</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary">התחבר</button>
                 <p id="auth-error" class="auth-error-message hidden"></p>
            </form>
            <div class="auth-divider">
                <span>או</span>
            </div>
            <button id="google-login-btn" class="btn btn-secondary google-btn">
                <svg viewBox="0 0 48 48" width="24px" height="24px"><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.904,36.336,44,30.65,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path></svg>
                <span>התחבר עם גוגל</span>
            </button>
        </div>
    </div>

    <div id="global-header" class="hidden">
        <p id="user-greeting" class="user-greeting"></p>
        <button id="logout-btn" title="התנתק">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"></path></svg>
        </button>
    </div>

    <div id="start-screen" class="hidden">
        <div class="start-content">
            <h1>משחק החיות</h1>
            <img id="start-screen-image" alt="חיות משחקות">
            <button id="go-to-setup-btn" class="btn btn-primary btn-large">התחל</button>
        </div>
    </div>

    <div id="setup-screen" class="container hidden">
        <h1 id="setup-game-title" class="setup-main-title">הגדרות משחק</h1>
        <main class="setup-grid">
            <div class="setup-box rules-box">
                <h2>הנחיות:</h2>
                <ul>
                    <li>* כל קבוצה עונה על שאלה בתורה.</li>
                    <li>* בתשובה נכונה מגרילים ניקוד חיובי</li>
                    <li>* בתשובה חלקית מגרילים ניקוד שלילי</li>
                    <li>* במקום הגרלה שלילית ניתן להעביר שאלה</li>
                    <li>* בסיום תהייה שאלה זהה שוברת שוויון לכולם</li>
                    <li>* רק ראש הקבוצה רשאי לענות את התשובה בשם קבוצתו</li>
                </ul>
                 <div class="stats">
                    <p id="question-bank-stat">בנק שאלות: 15</p>
                    <p id="actual-questions-stat">שאלות בפועל: 15</p>
                </div>
            </div>

            <div class="setup-box">
                <h2>בחר מספר קבוצות</h2>
                <ul id="group-list" class="selection-list">
                    <li>2</li>
                    <li>3</li>
                    <li class="selected">4</li>
                    <li>5</li>
                </ul>
            </div>
        </main>

        <footer class="options-container">
            <div class="public-toggle-container">
                <label for="shuffle-questions" class="public-toggle-label">ערבוב שאלות</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="shuffle-questions" checked>
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="public-toggle-container">
                <label for="continue-last-point" class="public-toggle-label">המשך מנקודה אחרונה</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="continue-last-point">
                    <span class="slider round"></span>
                </label>
            </div>
        </footer>
        
        <button id="start-btn" class="btn btn-primary">התחל</button>
    </div>

    <div id="join-host-screen" class="container hidden">
        <div class="join-host-content">
            <h1>קוד הצטרפות למשחק</h1>
            <p>שתף קוד זה עם המשתתפים או סרוק את קוד ה-QR</p>
            <div class="join-code-container">
                <div id="join-host-code-display" class="game-code-display" title="לחץ להעתקה">......</div>
                <div id="qrcode-container"></div>
            </div>
            <div id="join-host-teams-container">
                <!-- Team slots will be injected here by JS -->
            </div>
            <button id="start-game-from-join-btn" class="btn btn-primary btn-large">התחל משחק</button>
        </div>
    </div>

    <div id="pre-question-screen" class="hidden">
        <div class="pre-question-content">
            <h1 id="pre-question-game-title">משחק: הגנת סייבר</h1>
            <h2 id="pre-question-number">שאלה 1 מתוך 8</h2>
            <p id="pre-question-time">מספר שניות למתן תשובה: 30</p>
        </div>
        <div class="main-action-container">
            <button id="bet-question-btn" class="btn btn-secondary">שאלת ההימור</button>
            <button id="next-question-btn" class="btn btn-primary">השאלה הבאה</button>
        </div>
    </div>


    <div id="game-screen" class="hidden">
        <div class="game-header">
            <div class="timer-area">
                <div id="timer-container">
                    <svg class="timer-svg" viewBox="0 0 100 100">
                        <!-- Background track -->
                        <circle class="timer-bg-track" cx="50" cy="50" r="42" />
                        <!-- Progress ring -->
                        <circle id="timer-progress-ring" cx="50" cy="50" r="42" />
                    </svg>
                    <span id="timer-value">30</span>
                </div>
                <button id="answer-link-btn" class="btn-icon-round hidden" title="מידע נוסף">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-2zm-3-4h8v2H8v-2z"/></svg>
                </button>
            </div>
            <div id="q-a-wrapper">
                <div id="question-container">
                    <p id="question-text">מהי מתקפת פישינג?</p>
                </div>
                <div id="answer-container" class="hidden">
                    <p id="answer-text"></p>
                </div>
            </div>
        </div>

        <div id="game-controls" class="main-action-container">
            <button id="stop-game-btn" class="btn btn-secondary btn-medium">עצור</button>
            <div id="answer-controls" class="hidden">
                <button id="correct-answer-btn" class="answer-btn" title="תשובה נכונה">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                </button>
                <button id="incorrect-answer-btn" class="answer-btn" title="תשובה שגויה">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div id="failure-controls" class="hidden">
                <button id="failure-box-btn" class="btn btn-danger btn-medium">תיבת כישלון</button>
                <button id="pass-question-btn" class="btn btn-primary btn-medium">העבר שאלה</button>
            </div>
            <button id="victory-box-btn" class="btn btn-primary btn-medium hidden">תיבת נצחון</button>
        </div>
        
        <button id="undo-answer-choice-btn" class="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg>
        </button>
    </div>

    <div id="boxes-screen" class="hidden">
        <div class="boxes-content">
            <h1 id="boxes-title">תיבת ניצחון (10-50)</h1>
            <div id="chests-container">
                <div class="treasure-chest" data-chest="1">
                    <img src="" alt="Treasure Chest 1">
                    <span>1</span>
                </div>
                <div class="treasure-chest" data-chest="2">
                    <img src="" alt="Treasure Chest 2">
                    <span>2</span>
                </div>
                <div class="treasure-chest" data-chest="3">
                    <img src="" alt="Treasure Chest 3">
                    <span>3</span>
                </div>
            </div>
            <p id="boxes-message">יש לבחור תיבה</p>
        </div>
        <div class="main-action-container">
            <button id="return-from-boxes-btn" class="btn btn-primary">חזרה</button>
        </div>
    </div>

    <div id="betting-screen" class="container hidden">
        <div class="betting-content">
            <h1>שאלת ההימור הסופית</h1>
            <p>כל קבוצה מהמרת על הנקודות שצברה. במענה נכון, סכום ההימור יתווסף לניקוד. בטעות, הסכום יופחת.</p>
            <div id="betting-teams-container">
                <!-- Betting team cards will be injected here by JS -->
            </div>
            <button id="show-final-question-btn" class="btn btn-primary btn-large hidden">שאלת הסיכום</button>
        </div>
    </div>

    <div id="final-question-screen" class="container hidden">
        <div class="final-question-content">
            <h1>שאלת הסיכום</h1>
            <div id="final-q-a-wrapper">
                <div id="final-question-container">
                    <p id="final-question-text"></p>
                </div>
                <div id="final-answer-container" class="hidden">
                    <p id="final-answer-text"></p>
                     <button id="final-answer-link-btn" class="btn-icon-round hidden" title="מידע נוסף">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-2zm-3-4h8v2H8v-2z"/></svg>
                    </button>
                </div>
            </div>
            <button id="show-final-answer-btn" class="btn btn-secondary">הצג תשובה</button>
            <div id="final-scoring-container" class="hidden">
                <h2>מי ענה נכון?</h2>
                <div id="final-scoring-teams">
                    <!-- Final scoring controls for each team will be injected here -->
                </div>
            </div>
             <button id="end-game-btn" class="btn btn-primary btn-large hidden">סיים משחק וחזור למסך הראשי</button>
        </div>
    </div>


    <div id="edit-game-screen" class="container hidden">
        <div class="edit-header">
            <h1>בחר או ערוך משחק</h1>
        </div>

        <div class="edit-sticky-actions">
            <div class="main-edit-actions">
                <button type="button" id="play-selected-game-btn" class="btn btn-primary btn-medium" disabled>שחק במשחק</button>
            </div>
        </div>

        <div class="edit-game-layout">
            <div id="editor-panel">
                <div id="editor-toolbar" class="hidden">
                    <button type="button" id="toolbar-add-question-btn" class="btn-icon-round" title="הוסף שאלה">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                    </button>
                    <button type="button" id="toolbar-download-btn" class="btn-icon-round" title="הורד קובץ">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    </button>
                    <button type="button" id="toolbar-save-btn" class="btn-icon-round" title="שמור שינויים">
                        <svg class="save-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zM12 18c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zM6 6h9v4H6z"/></svg>
                        <svg class="saved-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                    </button>
                    <button type="button" id="toolbar-delete-btn" class="btn-icon-round btn-icon-danger" title="מחק משחק">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                    </button>
                </div>
                <form id="game-editor-form" class="hidden">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="game-name-input">שם המשחק:</label>
                            <input type="text" id="game-name-input" placeholder="הכנס שם למשחק">
                        </div>
                        <div class="form-group">
                            <label for="game-category-select">קטגוריה:</label>
                            <select id="game-category-select">
                                <!-- Options populated by JS -->
                            </select>
                        </div>
                        <div class="public-toggle-container">
                            <label for="game-public-checkbox" class="public-toggle-label">ציבורי</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="game-public-checkbox">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="game-description-input">תיאור:</label>
                        <textarea id="game-description-input" rows="3" placeholder="הכנס תיאור קצר למשחק"></textarea>
                    </div>
                    <div class="questions-header">
                        <h2>שאלות</h2>
                        <div class="question-toggle-controls">
                            <button type="button" id="toggle-all-questions-btn" class="btn-icon" title="כווץ/הרחב הכל">
                                <svg class="expand-icon-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 5.83L15.17 9l1.41-1.41L12 3 7.41 7.59 8.83 9 12 5.83zm0 12.34L8.83 15l-1.41 1.41L12 21l4.59-4.59L15.17 15 12 18.17z"/></svg>
                                <svg class="collapse-icon-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M7.41 18.59L8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"/></svg>
                            </button>
                        </div>
                    </div>
                    <div id="questions-editor-container">
                        <!-- Questions will be dynamically inserted here -->
                    </div>
                    <h2>שאלת הסיכום</h2>
                    <div class="form-group">
                        <label for="final-question-q-input">שאלה:</label>
                        <textarea id="final-question-q-input" rows="1" placeholder="הכנס את שאלת הסיכום"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="final-question-a-input">תשובה:</label>
                        <textarea id="final-question-a-input" rows="1" placeholder="הכנס את תשובת הסיכום"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="final-question-url-input">קישור להרחבה:</label>
                        <div class="input-with-button">
                            <input type="url" id="final-question-url-input" placeholder="הכנס קישור (אופציונלי)">
                            <button type="button" id="final-question-preview-btn" class="btn-icon preview-link-btn" title="תצוגה מקדימה של הקישור" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-2zm-3-4h8v2H8v-2z"/></svg>
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <div id="game-list-panel">
                <div class="panel-header">
                    <h2>בחר משחק</h2>
                    <div class="panel-header-actions">
                        <button type="button" id="duplicate-selected-game-btn" class="btn-icon-round" title="שכפל משחק נבחר" disabled>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                        </button>
                        <button type="button" id="create-new-game-btn" class="btn-icon-round" title="צור משחק חדש">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                        </button>
                    </div>
                </div>
                <ul id="game-list-ul">
                    <!-- Game list will be loaded here dynamically -->
                </ul>
            </div>

            <div id="category-panel">
                 <h2>בחר קטגוריה</h2>
                 <div id="category-list-container" class="category-list-container">
                    <!-- Categories will be loaded here dynamically -->
                 </div>
            </div>
        </div>


        <div id="new-game-modal-overlay" class="hidden">
            <div id="new-game-modal">
                <button id="close-new-game-modal-btn" class="modal-close-btn" title="סגור"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
                <h2>יצירת משחק חדש</h2>
                <div class="form-group">
                    <label for="new-game-name">שם המשחק:</label>
                    <input type="text" id="new-game-name" placeholder="לדוגמה: הכל על חלל">
                </div>
                <div class="form-group">
                    <label for="new-game-category">קטגוריה:</label>
                    <select id="new-game-category">
                       <!-- Options populated by JS -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="new-game-description">תיאור:</label>
                    <textarea id="new-game-description" rows="2" placeholder="תאר את המשחק בכמה מילים"></textarea>
                </div>
                <div class="public-toggle-container">
                    <label for="new-game-public" class="public-toggle-label">הפוך לציבורי (אחרים יוכלו לשחק)</label>
                    <label class="toggle-switch">
                        <input type="checkbox" id="new-game-public">
                        <span class="slider round"></span>
                    </label>
                </div>
                <div class="modal-actions">
                    <button id="confirm-new-game-btn" class="btn btn-primary btn-small">צור</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal-overlay" class="hidden">
        <div id="confirm-modal">
            <button id="close-confirm-modal-btn" class="modal-close-btn" title="סגור"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
            <h2 id="confirm-modal-title">אישור פעולה</h2>
            <p id="confirm-modal-text"></p>
            <div class="modal-actions" id="confirm-modal-yes-no-actions">
                <button id="confirm-modal-yes-btn" class="btn btn-primary btn-small">כן</button>
                <button id="confirm-modal-no-btn" class="btn btn-secondary btn-small">לא</button>
            </div>
            <div class="modal-actions hidden" id="confirm-modal-save-actions">
                <button id="confirm-modal-save-btn" class="btn btn-primary btn-small">שמור</button>
                <button id="confirm-modal-dont-save-btn" class="btn btn-danger btn-small">אל תשמור</button>
            </div>
        </div>
    </div>

    <!-- Pass Question Modal -->
    <div id="pass-question-modal-overlay" class="hidden">
        <div id="pass-question-modal">
            <button id="close-pass-question-modal-btn" class="modal-close-btn" title="סגור"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
            <h2>בחר קבוצה להעביר אליה את השאלה</h2>
            <div id="pass-question-teams-container">
                <!-- Team icons will be injected here by JS -->
            </div>
        </div>
    </div>

    <!-- Link Modal -->
    <div id="link-modal-overlay" class="hidden">
        <div id="link-modal">
            <button id="close-link-modal-btn" class="modal-close-btn" title="סגור">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            </button>
            <div class="link-modal-content">
                <div id="link-modal-loader"></div>
                <iframe id="link-modal-iframe" src="about:blank" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <!-- Question Preview Modal -->
    <div id="question-preview-modal-overlay" class="hidden">
        <div id="question-preview-modal">
            <button id="close-question-preview-modal-btn" class="modal-close-btn" title="סגור">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
            </button>
            <div class="question-preview-content">
                <h2>תצוגה מקדימה</h2>
                <div id="preview-question-container">
                    <p id="preview-question-text"></p>
                </div>
                <div id="preview-answer-container" class="hidden">
                    <p id="preview-answer-text"></p>
                </div>
                <button id="preview-show-answer-btn" class="btn btn-secondary btn-small">הצג תשובה</button>
            </div>
        </div>
    </div>


    <div class="global-top-left-controls">
        <button id="fullscreen-toggle-btn" class="global-control-btn">
            <svg id="fullscreen-enter-icon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
            <svg id="fullscreen-exit-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/></svg>
        </button>
        <button id="global-home-btn" class="global-control-btn hidden" title="חזור למסך הראשי">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z"/></svg>
        </button>
    </div>

    <!-- Persistent Game Footer -->
    <div id="main-game-footer" class="game-footer">
        <div class="score-controls">
            <button class="score-btn add-point-btn" tabindex="-1">+</button>
            <button class="score-btn subtract-point-btn" tabindex="-1">-</button>
        </div>
        <div id="main-teams-container" class="teams-container">
            <!-- Teams will be generated here by JS -->
        </div>
    </div>
    
    <div id="notification-toast"></div>

    <script src="index.js" type="module"></script>
</body>
</html>